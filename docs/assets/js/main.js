"use strict";const inputSearch=document.querySelector(".js_input"),btnSearch=document.querySelector(".js_btnSearch"),btnReset=document.querySelector(".js_btnReset"),animeResults=document.querySelector(".js_animeResults"),animeFav=document.querySelector(".js_animeFav");let data=[],dataFav=[];function getAnimeResult(){const e=inputSearch.value;fetch("https://api.jikan.moe/v3/search/anime?q="+e).then(e=>e.json()).then(e=>{data=e.results,renderAnimeResult()})}function renderAnimeResult(){animeResults.innerHTML="";for(const e of data){const a=dataFav.findIndex(a=>a.mal_id===e.mal_id);animeResults.innerHTML+=-1!==a?`<li class="js_animeList favourite" data-id=${e.mal_id}>\n        <img class="js_anime" data-id=${e.mal_id} src=${e.image_url} alt="Image of ${e.title}"><h3 class="js_animeTitle">${e.title}</h3>\n        </li>`:`<li class="js_animeList resultLi" data-id=${e.mal_id}>\n      <img class="js_anime" data-id=${e.mal_id} src=${e.image_url} alt="Image of ${e.title}"><h3 class="js_animeTitle">${e.title}</h3>\n      </li>`}addFavAnime()}function addFavAnime(){const e=document.querySelectorAll(".js_anime");for(const a of e)a.addEventListener("click",handleClickedAnime)}function handleClickedAnime(e){const a=parseInt(e.currentTarget.dataset.id),t=dataFav.find(e=>e.mal_id===a);if(void 0===t){e.target.parentNode.classList.add("favourite");const t=data.find(e=>e.mal_id===a);dataFav.push({mal_id:t.mal_id,image_url:t.image_url,title:t.title})}else{e.target.parentNode.classList.remove("favourite");const a=dataFav.indexOf(t);dataFav.splice(a,1)}renderAnimeFavResults(),setInLocalStorage()}function renderAnimeFavResults(){animeFav.innerHTML="";for(const e of dataFav)animeFav.innerHTML+=`<li class="js_animeFavList animeFavList" data-id=${e.mal_id}>\n        <img class="js_animeFav" src=${e.image_url} alt="Image of ${e.title}"><h3 class="js_animeFavTitle">${e.title}</h3><button class="js_BtnResetFav btnX">X</button>\n        </li>`;removeFavAnime()}function handleSearch(e){e.preventDefault(),""!==inputSearch.value?getAnimeResult():animeResults.innerHTML="<p>Introduce primero una serie :)</p>"}const getFromLocalStorage=()=>{const e=localStorage.getItem("dataFav");null!==e&&(dataFav=JSON.parse(e),renderAnimeFavResults())},setInLocalStorage=()=>{const e=JSON.stringify(dataFav);localStorage.setItem("dataFav",e)};function handleReset(e){e.preventDefault(),inputSearch.value="",dataFav=[],renderAnimeFavResults(),localStorage.removeItem("dataFav"),renderAnimeResult()}function removeFavAnime(){const e=document.querySelectorAll(".js_BtnResetFav");for(const a of e)a.addEventListener("click",handleRemoveFav)}function handleRemoveFav(e){const a=parseInt(e.currentTarget.parentElement.dataset.id),t=dataFav.find(e=>e.mal_id===a),n=dataFav.indexOf(t);dataFav.splice(n,1),setInLocalStorage(),renderAnimeFavResults(),renderAnimeResult()}btnSearch.addEventListener("click",handleSearch),getFromLocalStorage(),btnReset.addEventListener("click",handleReset);